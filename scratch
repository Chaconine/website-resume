<select name="Stats" id="stats">
  <option value="Aces" selected>Aces</option>
  <option value="Assists">Assists</option>
  <option value="Hitting">Hitting</option>
</select>

<div id="volleyball"></div>

<script type="text/javascript">
    var margin = { top: 0, right: 0, bottom: 80, left: 0 };
    var width = 622 - margin.left - margin.right;
    var height = 500 - margin.top - margin.bottom;

// append the svg object to the body of the page
var svg = d3.select("#volleyball")
    .insert("svg")
    .attr("width", width)
    .attr("height", height)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


var datasets = {Aces: "data/aces.csv",
                Assists: "data/assists.csv",
                Hitting: "data/hitting.csv"};

// A function that updates the chart
function update() {
        document.getElementById("volleyball").innerHTML="";

        // append the svg object to the body of the page
        var svg = d3.select("#volleyball")
            .insert("svg")
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        var path = datasets[document.getElementById("stats").value];

        
        //Read the data
        d3.csv(path).then(function(data) {
        console.log(data)
        //Set Ranges for X and Y scales
        var xScale = d3
            .scaleBand()
            .range([0, width])
            .padding(0.2);
        var yScale = d3
            .scaleLinear()
            .range([height, 0]);

        //Adding domain values to X and Y Scale
        xScale.domain(
            data.map(function (d) {
                return d.School;
            })
        );
        yScale.domain([
            0,
            d3.max(data, function (d) {
                return d.Per_Set;
            })
        ]);
            

        //X axis
        svg.append("g")
            .attr("class", "x axis")
            .call(d3.axisBottom(xScale))
            .attr("transform", "translate(0," + height + ")")


        //Y axis
        svg
            .append("g")
            .call(d3.axisLeft(yScale))
            .attr("transform", "translate(10,0)")
            .append("text")
            .text("Per Set")


        //Bars
        svg
            .selectAll(".bar")
            .data(data)
            .enter()
            .append("rect")
            .attr("x", function (d) {
                return xScale(d.School);
            })
            .attr("width", xScale.bandwidth())
            .attr("y", function (d) {
                return height;
            })
            .attr("height", function (d) {
                return height - yScale(d.Per_Set);
            });
    })
}

update()

// When the button is changed, run the updateChart function
d3.select("#stats").on("change", function(d) {
    update()
})
    
console.log("test")

</script>
